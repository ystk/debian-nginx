From: Christos Trochalakis <yatiohi@ideopolis.gr>
Date: Wed, 20 Nov 2013 00:26:42 +0200
Subject: Fix CVE-2013-4547

backport of changeset 5446:988c22615014 from the nginx repo.
http://hg.nginx.org/nginx/rev/988c22615014
---
 src/http/ngx_http_parse.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/http/ngx_http_parse.c b/src/http/ngx_http_parse.c
index be750ed..bda0b0d 100644
--- a/src/http/ngx_http_parse.c
+++ b/src/http/ngx_http_parse.c
@@ -614,6 +614,7 @@ ngx_http_parse_request_line(ngx_http_request_t *r, ngx_buf_t *b)
             default:
                 r->space_in_uri = 1;
                 state = sw_check_uri;
+                p--;
                 break;
             }
             break;
@@ -667,6 +668,7 @@ ngx_http_parse_request_line(ngx_http_request_t *r, ngx_buf_t *b)
             default:
                 r->space_in_uri = 1;
                 state = sw_uri;
+                p--;
                 break;
             }
             break;
