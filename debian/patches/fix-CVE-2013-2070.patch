Description: fix nginx proxy_pass buffer overflow
(CVE-2013-2070)
Forwarded: http://www.openwall.com/lists/oss-security/2013/05/13/3
--- a/src/http/modules/ngx_http_proxy_module.c
+++ b/src/http/modules/ngx_http_proxy_module.c
@@ -1864,6 +1864,10 @@
 
     }
 
+   if (ctx->size < 0 || ctx->length < 0) {
+        goto invalid;
+    }
+
     return rc;
 
 done:
